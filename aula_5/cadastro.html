<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - Store</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.min.js" integrity="sha384-VQqxDN0EQCkWoxt/0vsQvZswzTHUVOImccYmSyhJTp7kGtPed0Qcx8rK9h9YEgx+" crossorigin="anonymous"></script>
</head>
<body class="bg-light">
    <nav class="navbar navbar-expanded-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">Loja</a>
            <button class="navbar-toggler align-items-center text-white justify-content-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarnav">
                Menu
            </button>
            <!--
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarnav">
                <span class="navbar-toggler-icon"></span>
            </button>-->
            <div class="collapse navbar-collapse" id="navbarnav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="index.html">Início</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">Produto</a></li>
                    <li class="nav-item"><a class="nav-link active" href="contato.html">Contato</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">Login</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">Cadastro</a></li>
                </ul>
            </div>

        </div>
    </nav>

    <div class="container-fluid py-5"><!-- container-fluid = ocupar toda a tela | py-5 = padding-top e padding-bottom -->
        <div class="mb-4"><!-- mb-4 = margin-bottom | text-center = centralizar o texto -->
            <div class="container bg-white w-75 p-5 rounded shadow">
                <h2 class="mb-4 text-center">Cadastro de Cliente</h2>
                <form action="#" method="post" enctype="application/x-www-form-urlencoded">
                    
                    <div class="mb-3">
                        <label for="username" class="form-label">Nome completo:</label>
                        <input type="text" class="form-control" id="username" name="nome" placeholder="Digite seu nome completo" required>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="form-label">E-mail:</label>
                        <input type="text" class="form-control" id="email" name="email" placeholder="Digite seu e-mail" required>
                    </div>

                    <div class="mb-3">
                        <label for="password" class="form-label">Senha:</label>
                        <input type="text" class="form-control" id="password" name="email" placeholder="Digite sua senha" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="role" class="form-label">Função:</label>
                        <input type="text" class="form-control" id="role" name="role" placeholder="Digite sua função" required>
                    </div>

                    <div class="d-flex justify-content-between">
                        <button type="reset" class="btn btn-secondary">Limpar</button>
                        <button type="submit" class="btn btn-primary">Cadastrar</button>
                    </div>
                </form>
            </div>
        </div>
        <footer class="bg-dark text-white text-center py-4 mt-5">
            <p class="mb-0">&copy; 2025 Loja. Todos os direitos reservados.</p>
        </footer>
        <script>
            async function enviarCadastro(event){
                event.preventDefault(); // Impede o envio padrão do formulário

                const dados = {// Cria um objeto com os dados
                    username: document.getElementById('username').value, // Recupera o valor do input
                    email: document.getElementById('email').value,// Recupera o valor do input
                    password: document.getElementById('password').value,// Recupera o valor do input
                    role: document.getElementById('role').value// Recupera o valor do input
                };

                try {
                    const response = await fetch('http://localhost:8080/auth/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(dados)
                    });

                    if (response.ok) {
                        const resultado = await response.json();
                        alert('Cadastro realizado com sucesso!'); // Exibe uma mensagem de sucesso
                        console.log('Resposta da API', resultado);
                    } else {
                        const erro = await response.json();
                        alert(`Erro ao cadastrar: ${erro.message}`); // Exibe uma mensagem de erro
                    }
                } catch (erro) {
                    alert('Erro ao cadastrar', erro); // Exibe uma mensagem de erro
                }
            }

            document.querySelector('form').addEventListener('submit', enviarCadastro); // Adiciona o evento de submit ao formulário
        </script>
    </div>
    </body>
</html>